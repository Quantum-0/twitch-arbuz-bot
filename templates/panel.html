{% extends "base.html" %}

{% block title %}–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äî Quantum0's Bot{% endblock %}

{% block styles %}{{ super() }}

{% block head_scripts %}
<script src="/static/js/panel-scripts.js"></script>
{% endblock %}

/* TODO: Refactor!!! */
.memealert-coins-wrapper {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 10px;
}
.memealert-coins {
    display: flex;
    align-items: center;
    gap: 10px;
}
.memealert-coins .coin-btn {
    background-color: #4CAF50;
    color: #fff;
    border: none;
    border-radius: 5px;
    font-size: 20px;
    line-height: 1;
    padding: 6px 14px;
    margin: 0;
    cursor: pointer;
    transition: background-color 0.2s;
}
.memealert-coins .coin-btn:hover { background-color: #45a049; }
.memealert-coins input {
    width: 80px;
    text-align: center;
    padding: 8px;
    border: 2px solid #4CAF50;
    border-radius: 5px;
    background-color: #fff;
    font-size: 16px;
    margin: 0;
}

.overlay-section {
    margin-left: 20px;
    margin-top: 10px;
}

.overlay-title {
    margin-bottom: 6px;
}

.overlay-copy-input {
    width: 100%;
    padding: 8px 10px;
    border: 2px solid #4CAF50;
    border-radius: 5px;
    font-size: 14px;
    background-color: #f9fff9;
    cursor: pointer;
}

.overlay-copy-hint {
    display: block;
    margin-top: 4px;
    color: #666;
    font-size: 12px;
}
{% endblock %}

{% block content %}
<h2>–ü—Ä–∏–≤–µ—Ç, {{ user.login_name }}!</h2>
<p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞:</p>

<hr>

<section>
    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç-–±–æ—Ç–∞</h3>

    <!-- –ì–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å -->
    <div class="toggle-label">
        <span><b>–í–∫–ª—é—á–∏—Ç—å —á–∞—Ç-–±–æ—Ç–∞</b></span>
        <div class="toggle-switch {% if settings.enable_chat_bot %}active{% endif %}" data-name="enable_chat_bot"></div>
    </div>

    <hr>

    <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ -->
    <div id="dependent-toggles" class="toggles-grid">
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !–∫—É—Å—å</span>
            <div class="toggle-switch {% if settings.enable_bite %}active{% endif %}" data-name="enable_bite"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !–ª–∏–∑—å</span>
            <div class="toggle-switch {% if settings.enable_lick %}active{% endif %}" data-name="enable_lick"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !boop</span>
            <div class="toggle-switch {% if settings.enable_boop %}active{% endif %}" data-name="enable_boop"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !pat</span>
            <div class="toggle-switch {% if settings.enable_pat %}active{% endif %}" data-name="enable_pat"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !hug</span>
            <div class="toggle-switch {% if settings.enable_hug %}active{% endif %}" data-name="enable_hug"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !–±–∞–Ω–∞–Ω</span>
            <div class="toggle-switch {% if settings.enable_banana %}active{% endif %}" data-name="enable_banana"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !lurk</span>
            <div class="toggle-switch {% if settings.enable_lurk %}active{% endif %}" data-name="enable_lurk"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !—Ö–æ—Ä–Ω–∏</span>
            <div class="toggle-switch {% if settings.enable_horny_good %}active{% endif %}" data-name="enable_horny_good"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !—Ö–≤–æ—Å—Ç</span>
            <div class="toggle-switch {% if settings.enable_tail %}active{% endif %}" data-name="enable_tail"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !dice</span>
            <div class="toggle-switch {% if settings.enable_dice %}active{% endif %}" data-name="enable_dice"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !bonk</span>
            <div class="toggle-switch {% if settings.enable_bonk %}active{% endif %}" data-name="enable_bonk"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !—Ç—Ä—É—Å—ã</span>
            <div class="toggle-switch {% if settings.enable_pants %}active{% endif %}" data-name="enable_pants"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !—è–∫—Ç–æ</span>
            <div class="toggle-switch {% if settings.enable_whoami %}active{% endif %}" data-name="enable_whoami"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !–≤–∫—É—Å–Ω—è—à–∫–∞</span>
            <div class="toggle-switch {% if settings.enable_treat %}active{% endif %}" data-name="enable_treat"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !–ø–æ–∫–æ—Ä–º–∏—Ç—å</span>
            <div class="toggle-switch {% if settings.enable_feed %}active{% endif %}" data-name="enable_feed"></div>
        </div>
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !–ø–∞—Å—Ç–∞</span>
            <div class="toggle-switch {% if settings.enable_pasta %}active{% endif %}" data-name="enable_pasta"></div>
        </div>
        <!--
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å !–±—É–Ω–¥</span>
            <div class="toggle-switch {% if settings.enable_riot %}active{% endif %}" data-name="enable_riot"></div>
        </div>
        -->
        <!--
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–∏—Ä–∞–º–∏–¥–æ–∫ (–ø–æ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫—Ä–∏–≤–æ –æ.–û)</span>
            <div class="toggle-switch {% if settings.enable_pyramid %}active{% endif %}" data-name="enable_pyramid"></div>
        </div>
        -->
        <!--
        <div class="toggle-label {% if not settings.enable_chat_bot %}disabled{% endif %}">
            <span>–í–∫–ª—é—á–∏—Ç—å –ª–æ–º–∞—Ç–µ–ª—å –ø–∏—Ä–∞–º–∏–¥–æ–∫</span>
            <div class="toggle-switch {% if settings.enable_pyramid_breaker %}active{% endif %}" data-name="enable_pyramid_breaker"></div>
        </div>
        -->
    </div>
</section>

<hr>

<section>
    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ–º–∞–ª—ë—Ä—Ç–æ–≤</h3>
    {% if memealerts.enabled %}
        <button id="memealerts-btn" class="btn-danger" onclick="toggleMemealerts(false)">–û—Ç–∫–ª—é—á–∏—Ç—å –º–µ–º–∞–ª—ë—Ä—Ç—ã</button>
        <p>–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞:
            {% if memealerts.expires_in == 0 %}
                <span style="font-weight: bold; color: red;">{{ memealerts.expires_in }} –¥–Ω–µ–π</span>
            {% else %}
                {{ memealerts.expires_in }} –¥–Ω–µ–π
            {% endif %}. –ü–æ –∏—Å—Ç–µ—á–µ–Ω–∏—é —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞ –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å.
        </p>
        <button id="refresh-token-btn" onclick="openRefreshModal()">–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω</button>
        <div class="memealert-coins-wrapper">
            <span>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ–º–∫–æ–∏–Ω–æ–≤ –∑–∞ –Ω–∞–≥—Ä–∞–¥—É</span>
            <div class="memealert-coins">
                <!-- TODO: REFACTOR -->
                <button type="button" class="coin-btn" onclick="changeCoinCount(-1)">‚àí</button>
                <input type="number" id="coin-count" min="1" max="100" value="{{ memealerts.coins_for_reward }}">
                <button type="button" class="coin-btn" onclick="changeCoinCount(1)">+</button>
            </div>
        </div>
    {% else %}
        <button id="memealerts-btn" onclick="openActivateModal()">–í–∫–ª—é—á–∏—Ç—å –º–µ–º–∞–ª—ë—Ä—Ç—ã</button>
    {% endif %}
</section>

<hr>

<section>
    <h3>–î—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
    <div class="toggles-grid">
        <div class="toggle-label">
            <span>–í–∫–ª—é—á–∏—Ç—å shoutout –Ω–∞ —Ä–µ–π–¥—ã</span>
            <div class="toggle-switch {% if settings.enable_shoutout_on_raid %}active{% endif %}" data-name="enable_shoutout_on_raid"></div>
        </div>
    </div>
</section>

<hr>

<section>
    <h3>–û–≤–µ—Ä–ª–µ–∏</h3>
    <small class="overlay-copy-hint">
    <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–≤–µ—Ä–ª–µ–∏ –¥–ª—è —Å—Ç—Ä–∏–º–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∑—Ä–∏—Ç–µ–ª–µ–π –∫–∞–∫ –∏–∑ —á–∞—Ç–∞, —Ç–∞–∫ –∏ –∫–ª–∏–∫–∏ –º—ã—à–∫–æ–π –ø–æ —Å–∞–º–æ–º—É —Å—Ç—Ä–∏–º—É, —Å –ø–æ–º–æ—â—å—é –ø–ª–∞–≥–∏–Ω–∞ <a href="https://dashboard.twitch.tv/extensions/cr20njfkgll4okyrhag7xxph270sqk-2.1.1">Heat</a>.</p>
    <p>–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ <a href="https://dashboard.twitch.tv/extensions/cr20njfkgll4okyrhag7xxph270sqk-2.1.1">Heat</a>.</p>
    <p>–ü–æ—Å–ª–µ –µ–≥–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ - –≤—ã –∏ –≤–∞—à–∏ –∑—Ä–∏—Ç–µ–ª–∏ —É–≤–∏–¥–∏—Ç–µ –∫—Ä–∞—Å–Ω—É—é —Ç–æ—á–∫—É –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –º—ã—à–∏ –Ω–∞ —Å—Ç—Ä–∏–º. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ª—é–±—ã–µ –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –Ω–∏–∂–µ –æ–≤–µ—Ä–ª–µ–µ–≤.</p>
    <p>–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ–≤–µ—Ä–ª–µ—è –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≤ OBS, —É–∫–∞–∑–∞—Ç—å —Å—Å—ã–ª–∫—É, –≤—ã—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–µ –≤–∞—à–µ–º—É —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ–≤–µ—Ä–ª–µ—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥ —Ä–∞–∑–º–µ—Ä —Å—Ü–µ–Ω—ã, –∏–Ω–∞—á–µ –∫–ª–∏–∫–∏ –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.</p>
    </small>

    <div class="overlay-cards">
        <div class="overlay-card" data-base="{{ request.base_url }}overlay/star">
            <h2>–ó–≤—ë–∑–¥–æ—á–∫–∞</h2>
            <p>–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–∞–≤–µ—Ä—Ö—É —ç–∫—Ä–∞–Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∑–≤—ë–∑–¥–æ—á–∫—É, –∫–æ—Ç–æ—Ä—É—é –º–æ–≥—É—Ç —Ç—Ä–æ–≥–∞—Ç—å –∑—Ä–∏—Ç–µ–ª–∏</p>
            <div class="plugin-required">
                –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–≤–µ—Ä–ª–µ—è <b>–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</b> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Heat
                <br/>
                <button class="install-btn" onclick="setupHeat()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Heat</button>
            </div>
            <button class="overlay-toggle-settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <div class="overlay-settings">
<!--                <div class="overlay-control">-->
<!--                  Var 1-->
<!--                  <label class="switch">-->
<!--                    <input type="checkbox" data-param="var1" />-->
<!--                    <span class="slider"></span>-->
<!--                  </label>-->
<!--                </div>-->
                <div class="overlay-control">
                  –ü–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
                  <input type="range" min="0" max="1" step="0.01" value="0.5" data-param="pos"/>
                </div>
                <div class="overlay-control">
                  –†–∞–∑–º–µ—Ä
                  <input type="range" min="8" max="256" value="16" data-param="size" />
                </div>
            </div>
            <p>–°–∫–æ–ø–∏—Ä—É–π —Å—Å—ã–ª–∫—É –∏ –≤—Å—Ç–∞–≤—å –≤ OBS, —Ä–∞—Å—Ç—è–Ω—É–≤ –Ω–∞ –≤—Å—é —Å—Ü–µ–Ω—É:</p>
            <div class="overlay-link"></div>
        </div>

        <div class="overlay-card" data-base="{{ request.base_url }}overlay/pair">
            <h2>–ò–≥—Ä–∞ "–ù–∞–π–¥–∏ –ø–∞—Ä—É"</h2>
            <p>–ú–∏–Ω–∏-–∏–≥—Ä–∞ –≤ —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ –¥–≤—É—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –º–æ–≥—É—Ç –∫–ª–∏–∫–∞—Ç—å –∑—Ä–∏—Ç–µ–ª–∏, —á—Ç–æ–± –Ω–µ —Å–∫—É—á–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –≤—ã –∫—É–¥–∞-—Ç–æ –æ—Ç—Ö–æ–¥–∏—Ç–µ üëÄ</p>
            <div class="plugin-required">
                –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–≤–µ—Ä–ª–µ—è <b>–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</b> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Heat
                <br/>
                <button class="install-btn" onclick="setupHeat()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Heat</button>
            </div>
            <button class="overlay-toggle-settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <div class="overlay-settings">
                <div class="overlay-control">
                  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–º–∞–π–ª–∏–∫–æ–≤ —Ç–≤–∏—á–∞
                  <label class="switch">
                    <input type="checkbox" data-param="use_twitch_emoji" />
                    <span class="slider"></span>
                  </label>
                </div>
                <div class="overlay-control">
                  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∏–∫–µ—Ä–æ–≤ –∞–≤—Ç–æ—Ä–∞ –±–æ—Ç–∞
                  <label class="switch">
                    <input type="checkbox" data-param="arbuz" />
                    <span class="slider"></span>
                  </label>
                </div>
                <div class="overlay-control">
                  –û—Ç—Å—Ç—É–ø —Å–ª–µ–≤–∞
                  <input type="range" min="0" max="1" step="0.01" value="0.2" data-param="offset_left"/>
                </div>
                <div class="overlay-control">
                  –û—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞
                  <input type="range" min="0" max="1" step="0.01" value="0.2" data-param="offset_right"/>
                </div>
                <div class="overlay-control">
                  –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É
                  <input type="range" min="0" max="1" step="0.01" value="0.02" data-param="offset_top"/>
                </div>
                <div class="overlay-control">
                  –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É
                  <input type="range" min="0" max="1" step="0.01" value="0.05" data-param="offset_bottom"/>
                </div>
                <div class="overlay-control">
                  –†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫
                  <input type="range" min="0" max="1" step="0.01" value="0.87" data-param="card_scale"/>
                </div>
            </div>
            <p>–°–∫–æ–ø–∏—Ä—É–π —Å—Å—ã–ª–∫—É –∏ –≤—Å—Ç–∞–≤—å –≤ OBS, —Ä–∞—Å—Ç—è–Ω—É–≤ –Ω–∞ –≤—Å—é —Å—Ü–µ–Ω—É:</p>
            <div class="overlay-link"></div>
        </div>
    </div>
<!--    <div class="overlay-section">-->
<!--        <p class="overlay-title">-->
<!--            <a href="https://dashboard.twitch.tv/extensions/cr20njfkgll4okyrhag7xxph270sqk-2.1.1">Heat</a> –æ–≤–µ—Ä–ª–µ–π —Å –∏–≥—Ä–æ–π —É–≥–∞–¥–∞–π –ø–∞—Ä—É-->
<!--        </p>-->
<!--        <input-->
<!--            class="overlay-copy-input"-->
<!--            type="text"-->
<!--            value="{{ request.base_url }}overlay/pair?channel_id={{ user.twitch_id }}"-->
<!--            readonly-->
<!--            onclick="this.select(); navigator.clipboard.writeText(this.value); showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ', '–°—Å—ã–ª–∫–∞ –¥–ª—è OBS —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');"-->
<!--        >-->
<!--        <small class="overlay-copy-hint">-->
<!--            –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É. –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å <a href="https://dashboard.twitch.tv/extensions/cr20njfkgll4okyrhag7xxph270sqk-2.1.1">Heat</a>.-->
<!--        </small>-->
<!--    </div>-->
<!--    <div class="overlay-section">-->
<!--        <p class="overlay-title">-->
<!--            <a href="https://dashboard.twitch.tv/extensions/cr20njfkgll4okyrhag7xxph270sqk-2.1.1">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π</a> –æ–≤–µ—Ä–ª–µ–π —Å –≤–∏—Å—è—â–µ–π –∑–≤—ë–∑–¥–æ—á–∫–æ–π-->
<!--        </p>-->
<!--        <input-->
<!--            class="overlay-copy-input"-->
<!--            type="text"-->
<!--            value="{{ request.base_url }}overlay/star?channel_id={{ user.twitch_id }}"-->
<!--            readonly-->
<!--            onclick="this.select(); navigator.clipboard.writeText(this.value); showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ', '–°—Å—ã–ª–∫–∞ –¥–ª—è OBS —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');"-->
<!--        >-->
<!--        <small class="overlay-copy-hint">-->
<!--            –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É. –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å <a href="https://dashboard.twitch.tv/extensions/cr20njfkgll4okyrhag7xxph270sqk-2.1.1">Heat</a>.-->
<!--        </small>-->
<!--        &lt;!&ndash;-->
<!--        <div class="overlay-control">-->
<!--            <label>-->
<!--                –ü–æ–∑–∏—Ü–∏—è (pos):-->
<!--                <span id="pos-value">‚Äî</span>-->
<!--            </label>-->
<!--            <input-->
<!--                type="range"-->
<!--                min="0"-->
<!--                max="1"-->
<!--                step="0.01"-->
<!--                value=""-->
<!--                oninput="updatePos(this.value)"-->
<!--            >-->
<!--        </div>-->
<!--        <div class="overlay-control">-->
<!--            <label>–†–∞–∑–º–µ—Ä –∑–≤–µ–∑–¥—ã (size):</label>-->
<!--            <div class="memealert-coins">-->
<!--                <button type="button" class="coin-btn" onclick="changeStarSize(-1)">‚àí</button>-->
<!--                <input type="number" id="star-size" min="1" max="100" value="20" oninput="updateUrl()">-->
<!--                <button type="button" class="coin-btn" onclick="changeStarSize(1)">+</button>-->
<!--            </div>-->
<!--        </div>-->
<!--        &ndash;&gt;-->
<!--    </div>-->
<!--    {% if user and user.login_name in ["quantum075", "d_e_l_y", "silverosemary"] %}-->
<!--    <div class="overlay-section">-->
<!--        <p class="overlay-title">-->
<!--            –ú–æ—è —Ç–µ—Å—Ç–æ–≤–∞—è —à—Ç—É–∫–∞, –ù–ï –¢–†–û–ì–ê–ô–¢–ï-->
<!--        </p>-->
<!--        <input-->
<!--            class="overlay-copy-input"-->
<!--            type="text"-->
<!--            value="{{ request.base_url }}overlay/ai-sticker?channel_id={{ user.twitch_id }}"-->
<!--            readonly-->
<!--            onclick="this.select(); navigator.clipboard.writeText(this.value); showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ', '–°—Å—ã–ª–∫–∞ –¥–ª—è OBS —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');"-->
<!--        >-->
<!--        <small class="overlay-copy-hint">-->
<!--            –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É.-->
<!--        </small>-->
<!--        <button id="setup-ai-sticker-btn" onclick="setupAiStickerReward()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>-->
<!--    </div>-->
    {% endif %}
</section>

<div class="notification-container"></div>

<div class="modal" id="memealert-modal">
    <div class="modal-content bg-liquid-glass">
        <h3>–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á</h3>
        <input type="text" id="memealert-key" placeholder="–í–∞—à –∫–ª—é—á">
        <a class="tutorial-link" href="/memealerts-tutorial" target="_blank"><b>–ö–∞–∫ –µ–≥–æ –ø–æ–ª—É—á–∏—Ç—å?</b></a>
        <p>–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏–ª–æ—Å—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞ - –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–∞–º–æ–º Memealerts.</p>
        <div class="modal-buttons">
            <button type="button" class="btn-cancel" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
            <button type="button" id="save-btn" onclick="saveMemealert()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>
</div>

<script>
    function updateOverlayLink(card) {
    const base = card.dataset.base;
    const params = new URLSearchParams();

    params.set("channel_id", {{ user.twitch_id }});

    card.querySelectorAll("[data-param]").forEach(el => {
        const key = el.dataset.param;
        if (el.type === "checkbox") {
            params.set(key, el.checked);
        } else {
            params.set(key, el.value);
        }
    });

    const link = base + "?" + params.toString();
    const linkDiv = card.querySelector(".overlay-link");
    linkDiv.textContent = link;
}

document.querySelectorAll(".overlay-card").forEach(card => {

    const linkDiv = card.querySelector(".overlay-link");

    card.querySelectorAll("[data-param]").forEach(el => {
        el.addEventListener("input", () => updateOverlayLink(card));
    });

    card.querySelector(".overlay-toggle-settings").addEventListener("click", () => {
        card.querySelector(".overlay-settings").classList.toggle("active");
    });

    linkDiv.addEventListener("click", () => {
        navigator.clipboard.writeText(linkDiv.textContent);
        linkDiv.classList.add("copied");
        linkDiv.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!";
        setTimeout(() => {
            updateOverlayLink(card);
            linkDiv.classList.remove("copied");
        }, 1000);
    });

    updateOverlayLink(card);
});

fetch('/api/user/check-heat-installed', {
    method: 'GET',
    headers: { 'Content-Type': 'application/json' },
})
.then(res => res.json().then(data => ({ ok: res.ok, data })))
.then((
    {ok, data}) => {
        if (ok) {
            document.querySelectorAll('div.plugin-required').forEach(element => {
                element.remove();
            })
        };
    }
);
</script>
{% endblock %}
